webpackJsonp([1],{"+aoJ":function(t,e){},0:function(t,e){},"04J0":function(t,e){},1:function(t,e){},"4EmT":function(t,e){},"4Zhw":function(t,e){},"6tpM":function(t,e){},"89aD":function(t,e){},"8YcA":function(t,e){},"8rdy":function(t,e){},BqhT:function(t,e){},CztN:function(t,e){},ELC4:function(t,e){},FGnn:function(t,e){},"I+gA":function(t,e){},LVhj:function(t,e){},NBeX:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("//Fk"),a=s.n(i),n=s("7+uW"),r=s("mtWM"),o=s.n(r),c=s("mvHQ"),l=s.n(c),d=s("Dd8w"),u=s.n(d),_=s("NYxO"),h={computed:u()({},Object(_.c)({form:"LOGIN_G_GET_FORM"}))},v={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-control-label",attrs:{for:"logInUsername"}},[t._v("Username")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.email,expression:"form.email"}],staticClass:"form-control",attrs:{id:"logInUsername",maxlength:"16",name:"name",placeholder:"Enter your email or username here",type:"text"},domProps:{value:t.form.email},on:{input:function(e){e.target.composing||t.$set(t.form,"email",e.target.value)}}})])},staticRenderFns:[]},f=s("VU/8")(h,v,!1,function(t){s("fVrm")},"data-v-891114c6",null).exports,m={data:function(){return{errorMessage:"",password:""}},computed:u()({},Object(_.c)({form:"LOGIN_G_GET_FORM"}))},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-control-label",attrs:{for:"logInPassword"}},[t._v("Password")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.password,expression:"form.password"}],staticClass:"form-control",attrs:{id:"logInPassword",maxlength:"100",name:"name",placeholder:"Enter your password",type:"password"},domProps:{value:t.form.password},on:{input:function(e){e.target.composing||t.$set(t.form,"password",e.target.value)}}})])},staticRenderFns:[]},g={props:["show"],data:function(){return{time:0,duration:5e3}},components:{PasswordField:s("VU/8")(m,p,!1,function(t){s("lJ/D")},"data-v-94abf24c",null).exports,UsernameField:f},methods:u()({},Object(_.b)({submit:"LOGIN_SEND_A_LOGIN_REQUEST"}),{beforeOpen:function(t){console.log(t),this.time=Date.now()},beforeClose:function(t){console.log(t),this.time+this.duration<Date.now()&&t.stop()}})},C={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("transition",{attrs:{name:"modal"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"modal-mask"},[s("div",{staticClass:"modal-container"},[s("div",{staticClass:"text-right close-modal"},[s("i",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"},on:{click:function(e){t.$emit("close")}}})]),t._v(" "),s("div",{staticClass:"modal-header"},[s("h3",{staticClass:"text-info"},[t._v("Log In Werewolf")])]),t._v(" "),s("div",{staticClass:"modal-body"},[s("label",{staticClass:"form-label"},[s("username-field"),t._v(" "),s("password-field")],1)]),t._v(" "),s("div",{staticClass:"modal-footer text-right"},[s("button",{staticClass:"btn btn-outline-info",on:{click:t.submit}},[t._v("\n                    Submit\n                ")])])])])])},staticRenderFns:[]},T=s("VU/8")(g,C,!1,function(t){s("zNuj")},"data-v-aaf17734",null).exports,E={data:function(){return{isValid:!1,isTouched:!0,errorMessage:"",age:""}},methods:u()({},Object(_.d)({setField:"SIGN_UP_M_SET_FIELD"}),{validateField:function(){this.isTouched&&(this.isTouched=!1),""===this.age?(this.isValid=!1,this.errorMessage="Field mustn't be empty",this.setField({field:"age",state:!1})):Number(this.age)>110||!function(t){return!isNaN(parseFloat(t))&&isFinite(t)}(this.age)||"0"===this.age[0]?(this.isValid=!1,this.errorMessage="Entered age is not valid!",this.setField({field:"age",state:!1})):(this.isValid=!0,this.setField({field:"age",state:!0,value:this.age}))}})},S={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-control-label",attrs:{for:"signUpAge"}},[t._v("Age")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.age,expression:"age"}],staticClass:"form-control",class:{"is-invalid":!t.isValid&&!t.isTouched},attrs:{id:"signUpAge",name:"name",maxlength:"100",type:"number"},domProps:{value:t.age},on:{input:[function(e){e.target.composing||(t.age=e.target.value)},t.validateField]}}),t._v(" "),t.isValid||t.isTouched?t._e():s("div",{staticClass:"invalid-feedback"},[t._v(t._s(t.errorMessage))])])},staticRenderFns:[]},A=s("VU/8")(E,S,!1,function(t){s("x094")},"data-v-043ba398",null).exports,b={props:["serverResponse"],data:function(){return{isValid:!1,isTouched:!0,signalNoticed:!1,errorMessage:"",pattern:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,email:""}},watch:{serverResponse:function(){this.validateField()}},methods:u()({},Object(_.d)({setField:"SIGN_UP_M_SET_FIELD"}),{validateField:function(){this.isTouched&&(this.isTouched=!1),this.signalNoticed||-1===this.serverResponse.errmsg.indexOf("email")?0===this.email.length?(this.isValid=!1,this.errorMessage="Field mustn't be empty!",this.setField({field:"email",state:!1})):this.email.match(this.pattern)?(this.isValid=!0,this.setField({field:"email",state:!0,value:this.email})):(this.isValid=!1,this.errorMessage="Entered email is not valid!",this.setField({field:"email",state:!1})):(this.signalNoticed=!0,this.isValid=!1,this.errorMessage="User with this email already exists!")}})},I={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-control-label",attrs:{for:"signUpEmail"}},[t._v("Email")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control",class:{"is-invalid":!t.isValid&&!t.isTouched},attrs:{id:"signUpEmail",name:"name",maxlength:"100",type:"text"},domProps:{value:t.email},on:{input:[function(e){e.target.composing||(t.email=e.target.value)},t.validateField]}}),t._v(" "),t.isValid||t.isTouched?t._e():s("div",{staticClass:"invalid-feedback"},[t._v(t._s(t.errorMessage))])])},staticRenderFns:[]},O=s("VU/8")(b,I,!1,function(t){s("sXC1")},"data-v-34a6f88f",null).exports,w={data:function(){return{isValid:!1,isTouched:!0,errorMessage:"",passwordConfirmation:""}},computed:u()({},Object(_.c)({form:"SIGN_UP_G_GET_FORM"})),methods:u()({},Object(_.d)({setField:"SIGN_UP_M_SET_FIELD"}),{validateField:function(){this.isTouched&&(this.isTouched=!1),this.passwordConfirmation!==this.form.password.value?(this.isValid=!1,this.errorMessage="Passwords do not match!",this.setField({field:"passwordConf",state:!1})):(this.isValid=!0,this.setField({field:"passwordConf",state:!0,value:this.passwordConfirmation}))}})},N={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-control-label",attrs:{for:"signUpPasswordConfirmation"}},[t._v("Repeat your password")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.passwordConfirmation,expression:"passwordConfirmation"}],staticClass:"form-control",class:{"is-invalid":!t.isValid&&!t.isTouched},attrs:{id:"signUpPasswordConfirmation",name:"name",maxlength:"100",type:"password"},domProps:{value:t.passwordConfirmation},on:{input:[function(e){e.target.composing||(t.passwordConfirmation=e.target.value)},t.validateField]}}),t._v(" "),t.isValid||t.isTouched?t._e():s("div",{staticClass:"invalid-feedback"},[t._v(t._s(t.errorMessage))])])},staticRenderFns:[]},R=s("VU/8")(w,N,!1,function(t){s("04J0")},"data-v-48f73282",null).exports,G={data:function(){return{isValid:!1,isTouched:!0,errorMessage:"",password:""}},methods:u()({},Object(_.d)({setField:"SIGN_UP_M_SET_FIELD"}),{validateField:function(){this.isTouched&&(this.isTouched=!1),0===this.password.length?(this.isValid=!1,this.errorMessage="Field mustn't be empty!",this.setField({field:"password",state:!1})):this.password.length<8?(this.isValid=!1,this.errorMessage="Entered password is too short!",this.setField({field:"password",state:!1})):this.password.match("^[A-Za-z0-9]+$")?(this.isValid=!0,this.setField({field:"password",state:!0,value:this.password})):(this.isValid=!1,this.errorMessage="Entered password is not valid!",this.setField({field:"password",state:!1}))}})},U={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-control-label",attrs:{for:"signUpPassword"}},[t._v("Password")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",class:{"is-invalid":!t.isValid&&!t.isTouched},attrs:{id:"signUpPassword",name:"name",maxlength:"100",type:"password"},domProps:{value:t.password},on:{input:[function(e){e.target.composing||(t.password=e.target.value)},t.validateField]}}),t._v(" "),t.isValid||t.isTouched?t._e():s("div",{staticClass:"invalid-feedback"},[t._v(t._s(t.errorMessage))])])},staticRenderFns:[]},y=s("VU/8")(G,U,!1,function(t){s("WVy+")},"data-v-46a93267",null).exports,F={data:function(){return{isValid:!1,isTouched:!0,errorMessage:"",phone:""}},methods:u()({},Object(_.d)({setField:"SIGN_UP_M_SET_FIELD"}),{validateField:function(){this.isTouched&&(this.isTouched=!1),0===this.phone.length?(this.isValid=!1,this.errorMessage="Field mustn't be empty!",this.setField({field:"phone",state:!1})):(this.isValid=!0,this.setField({field:"phone",state:!0,value:this.phone}))}})},L={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-control-label",attrs:{for:"signUpPhone"}},[t._v("Phone number")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"phone"}],staticClass:"form-control",class:{"is-invalid":!t.isValid&&!t.isTouched},attrs:{id:"signUpPhone",name:"name",maxlength:"100",type:"number"},domProps:{value:t.phone},on:{input:[function(e){e.target.composing||(t.phone=e.target.value)},t.validateField]}}),t._v(" "),t.isValid||t.isTouched?t._e():s("div",{staticClass:"invalid-feedback"},[t._v(t._s(t.errorMessage))])])},staticRenderFns:[]},x=s("VU/8")(F,L,!1,function(t){s("8YcA")},"data-v-91d62132",null).exports,M={computed:u()({},Object(_.c)({form:"SIGN_UP_G_GET_FORM"})),methods:u()({},Object(_.d)({setField:"SIGN_UP_M_SET_FIELD"}),{switcher:function(t){this.setField({field:"gender",state:!0,value:t})}})},H={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{class:{active:"male"===t.form.gender.value},attrs:{id:"on"},on:{click:function(e){t.switcher("male")}}},[t._v("\n        Male\n    ")]),t._v(" "),s("div",{class:{active:"female"===t.form.gender.value},attrs:{id:"off"},on:{click:function(e){t.switcher("female")}}},[t._v("\n        Female\n    ")])])},staticRenderFns:[]},V=s("VU/8")(M,H,!1,function(t){s("vcTv")},"data-v-9f38b37e",null).exports,k={props:["serverResponse"],data:function(){return{isValid:!1,isTouched:!0,signalNoticed:!1,errorMessage:"",username:""}},watch:{serverResponse:function(){console.log(this.serverResponse),this.validateField()}},methods:u()({},Object(_.d)({setField:"SIGN_UP_M_SET_FIELD"}),{validateField:function(){this.isTouched&&(this.isTouched=!1),this.signalNoticed||-1===this.serverResponse.errmsg.indexOf("username")?0===this.username.length?(this.isValid=!1,this.errorMessage="Field mustn't be empty!",this.setField({field:"username",state:!1})):this.username.match("^[A-Za-z0-9_.]+$")?(this.isValid=!0,this.setField({field:"username",state:!0,value:this.username})):(this.isValid=!1,this.errorMessage="Entered username is not valid!",this.setField({field:"username",state:!1})):(this.signalNoticed=!0,this.isValid=!1,this.errorMessage="This username already exists!")}})},P={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-control-label",attrs:{for:"signUpUsername"}},[t._v("Username")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"form-control",class:{"is-invalid":!t.isValid&&!t.isTouched},attrs:{id:"signUpUsername",name:"name",maxlength:"16",type:"text"},domProps:{value:t.username},on:{input:[function(e){e.target.composing||(t.username=e.target.value)},t.validateField]}}),t._v(" "),t.isValid||t.isTouched?t._e():s("div",{staticClass:"invalid-feedback"},[t._v(t._s(t.errorMessage))])])},staticRenderFns:[]},D=s("VU/8")(k,P,!1,function(t){s("8rdy")},"data-v-fe28d59c",null).exports,$={props:["show"],data:function(){return{duration:5e3,pass:!1,time:0}},computed:u()({},Object(_.c)({form:"SIGN_UP_G_GET_FORM",formIsValid:"SIGN_UP_G_GET_IS_VALID",serverResponse:"SIGN_UP_G_GET_SERVER_RESPONSE"})),components:{AgeField:A,EmailField:O,PasswordConfirmationField:R,PasswordField:y,PhoneField:x,Switcher:V,UsernameField:D},watch:{form:{handler:function(){this.validateForm()},deep:!0}},methods:u()({},Object(_.b)({submit:"LOGIN_SEND_A_SIGN_UP_REQUEST"}),Object(_.d)({validateForm:"SIGN_UP_M_VALIDATE_FORM"}),{beforeOpen:function(t){this.time=Date.now()},beforeClose:function(t){this.time+this.duration<Date.now()&&t.stop()}})},j={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("transition",{attrs:{name:"modal"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"modal-mask"},[s("div",{staticClass:"container"},[s("div",{staticClass:"text-right close-modal"},[s("i",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"},on:{click:function(e){t.$emit("close")}}})]),t._v(" "),s("div",{staticClass:"modal-header"},[s("h2",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v("Sign up on "),s("span",{staticClass:"logo"},[t._v("Werewolf")])])]),t._v(" "),s("div",{staticClass:"modal-body"},[s("form",[s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("username-field",{attrs:{serverResponse:t.serverResponse}})],1),t._v(" "),s("div",{staticClass:"col"},[s("email-field",{attrs:{serverResponse:t.serverResponse}})],1)]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("password-field")],1),t._v(" "),s("div",{staticClass:"col"},[s("password-confirmation-field")],1)]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("phone-field")],1),t._v(" "),s("div",{staticClass:"col"},[s("age-field")],1)]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"label"},[t._v("Choose your gender")]),t._v(" "),s("switcher")],1)]),t._v(" "),s("hr",{staticClass:"modal-divider"})]),t._v(" "),s("div",{staticClass:"modal-footer text-right"},[s("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Close")]),t._v(" "),s("button",{staticClass:"btn btn-primary",attrs:{type:"button",disabled:!t.formIsValid},on:{click:t.submit}},[t._v("Submit")])])])])])},staticRenderFns:[]},K=s("VU/8")($,j,!1,function(t){s("c0I7")},"data-v-10c21a08",null).exports,W={name:"AppHeader",data:function(){return{showLogInModal:!1,showSignUpModal:!1}},computed:u()({},Object(_.c)({currentUser:"SESSION_G_GET_CURRENT_USER",userType:"SESSION_G_GET_USER_TYPE"})),components:{LogInModal:T,SignUpModal:K},methods:u()({},Object(_.b)({logOut:"SESSION_LOG_OUT"}),{logOutWrapper:function(){this.$router.push("/"),this.logOut()}})},q={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("nav",{staticClass:"navbar navbar-expand-lg navbar-light"},[s("router-link",{staticClass:"navbar-brand text-info",attrs:{tag:"div",to:"/",exact:"",href:"#"}},[t._v("Werewolf")]),t._v(" "),t._m(0,!1,!1),t._v(" "),s("div",{staticClass:"collapse navbar-collapse",attrs:{id:"navbarSupportedContent"}}),t._v(" "),s("ul",{staticClass:"nav navbar-nav navbar-right"},[s("li",[s("a",{attrs:{href:"#"}},["user"===t.userType||"admin"===t.userType?s("div",{staticClass:"loggedAs"},[t._v("\n                        Logged in as "),s("span",[t._v(t._s(t.currentUser.username))])]):s("div",{staticClass:"sign"},[s("a",{attrs:{href:"#","data-toggle":"modal"},on:{click:function(e){t.showLogInModal=!0}}},[t._v("log in")]),t._v("\n                        |\n                        "),s("a",{attrs:{href:"#","data-toggle":"modal"},on:{click:function(e){t.showSignUpModal=!0}}},[t._v("sign up")])])])]),t._v(" "),s("li",["user"===t.userType||"admin"===t.userType?s("a",{staticClass:"logout",attrs:{href:"#"},on:{click:t.logOutWrapper}},[t._v("\n                    log out\n                ")]):t._e()])])],1),t._v(" "),s("sign-up-modal",{attrs:{show:t.showSignUpModal&&!t.currentUser.username},on:{close:function(e){t.showSignUpModal=!1}}}),t._v(" "),s("log-in-modal",{attrs:{show:t.showLogInModal&&!t.currentUser.username},on:{close:function(e){t.showLogInModal=!1}}})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"navbar-toggler",attrs:{type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"}},[e("span",{staticClass:"navbar-toggler-icon"})])}]},B=s("VU/8")(W,q,!1,function(t){s("tZXH")},"data-v-d5229866",null).exports,z={name:"SideBar",computed:u()({},Object(_.c)({countOfNotifications:"CHATLIST_G_GET_COUNT_OF_NOTIFICATIONS",user:"SESSION_G_GET_CURRENT_USER"}),{notifications:function(){return this.user.notifications?this.user.notifications.filter(function(t){return"pending"===t.state}):[]}})},Y={render:function(){var t=this.$createElement,e=this._self._c||t;return e("ul",{staticClass:"nav flex-column"},[e("li",{staticClass:"nav-item"},[e("router-link",{staticClass:"nav-link",attrs:{"active-class":"text-info",exact:"",tag:"div",to:"/"}},[this._v("Home")])],1),this._v(" "),e("li",{staticClass:"nav-item"},[e("router-link",{staticClass:"nav-link",attrs:{"active-class":"text-info",tag:"div",to:"/profile"}},[this._v("Profile")])],1),this._v(" "),e("li",{staticClass:"nav-item"},[e("router-link",{staticClass:"nav-link",attrs:{"active-class":"text-info",tag:"div",to:"/chats"}},[this._v("\n            Chats\n            "),e("span",{directives:[{name:"show",rawName:"v-show",value:0!==this.countOfNotifications,expression:"countOfNotifications !== 0"}],staticClass:"badge badge-secondary"},[this._v(this._s(this.countOfNotifications))])])],1),this._v(" "),e("li",{staticClass:"nav-item"},[e("router-link",{staticClass:"nav-link",attrs:{"active-class":"text-info",tag:"div",to:"/notifications"}},[this._v("\n            Notifications\n            "),e("span",{directives:[{name:"show",rawName:"v-show",value:0!==this.notifications.length,expression:"notifications.length !== 0"}],staticClass:"badge badge-secondary"},[this._v(this._s(this.notifications.length))])])],1)])},staticRenderFns:[]},J={name:"AppContent",components:{SideBar:s("VU/8")(z,Y,!1,function(t){s("tOWJ")},"data-v-0231fd24",null).exports}},Z={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-lg-2 col-md-3"},[e("side-bar")],1),this._v(" "),e("transition",{attrs:{name:"slide",mode:"out-in"}},[e("router-view",{staticClass:"col-lg-10 col-md-9"})],1)],1)},staticRenderFns:[]},X=s("VU/8")(J,Z,!1,function(t){s("NBeX")},"data-v-6393947a",null).exports,Q=new n.a({data:function(){return{queueState:"noErrors",errors:[],currentError:null}},methods:{pushError:function(t){this.errors.push(t),console.log(this.errors)},shiftError:function(){this.currentError=this.errors.shift(),this.$emit("error",this.currentError),this.queueState="showingError"}},watch:{queueState:function(t){var e=this;"ready"===t?this.shiftError():"showingError"===t&&setTimeout(function(){e.currentError=null,0===e.errors.length?(e.queueState="noErrors",e.$emit("error",null)):e.queueState="ready"},4e3)},errors:function(t){console.log("NEW ERRORS",t),1===t.length&&"showingError"!==this.queueState&&(this.queueState="ready")}},created:function(){var t=this;this.$on("pushError",function(e){t.pushError(e)})}}),tt={data:function(){return{currentError:null}},watch:{errors:function(t){console.log("errors errors errors",t)}},created:function(){var t=this;Q.$on("error",function(e){t.currentError=e})}},et={render:function(){var t=this.$createElement,e=this._self._c||t;return this.currentError?e("div",{staticClass:"row error-box alert-danger bg-danger text-center"},[e("div",{staticClass:"col-lg-12"},[this._v("\n        "+this._s(this.currentError.message)+"\n    ")])]):this._e()},staticRenderFns:[]},st=s("VU/8")(tt,et,!1,function(t){s("r2+L")},"data-v-0e967a17",null).exports,it={name:"App",computed:u()({},Object(_.c)({unauthorized:"SOCKET_IO_G_GET_UNAUTHORIZED"})),components:{AppHeader:B,AppContent:X,ErrorBox:st},watch:{unauthorized:function(t){if(t){var e=JSON.parse(localStorage.getItem("data"));e.token=null,localStorage.setItem("data",l()(e)),this.$router.push("/")}}},methods:u()({},Object(_.b)({initApp:"APP_A_INIT_APP"})),created:function(){this.initApp()}},at={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"component-app"},[e("div",{staticClass:"container app-header-container"},[e("app-header")],1),this._v(" "),e("div",{staticClass:"header-divider"}),this._v(" "),e("div",{staticClass:"container"},[e("app-content")],1),this._v(" "),e("div",{staticClass:"error-box-wraper"},[e("div",{staticClass:"container"},[e("error-box",{staticClass:"errbox"})],1)])])},staticRenderFns:[]},nt=s("VU/8")(it,at,!1,function(t){s("+aoJ")},null,null).exports,rt=s("4TSb"),ot=s.n(rt),ct=s("ORbq"),lt=s("/ocq"),dt={name:"WwHeader",props:{title:{type:String,default:"Title sample"}}},ut={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ww-box-header"},[e("h5",[this._v(this._s(this.title))]),this._v(" "),e("hr")])},staticRenderFns:[]},_t=s("VU/8")(dt,ut,!1,function(t){s("g1dx")},"data-v-028fea79",null).exports,ht={name:"Notification",props:{content:{type:String,default:"notice content"},index:{type:Number},title:{type:String,default:"Notice title"},shortcut:{type:Boolean,default:!1},src:{type:String,default:null},state:{type:String}}},vt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"media"},[t.src?s("img",{staticClass:"mr-3",attrs:{src:t.src,alt:"Generic placeholder image"}}):t._e(),t._v(" "),s("div",{staticClass:"media-body"},[s("h5",{staticClass:"ml-3 mt-2"},[t._v(t._s(t.title))]),t._v(" "),s("p",{staticClass:"ml-3 mb-2"},[t._v(t._s(t.content))]),t._v(" "),s("hr"),t._v(" "),s("div",{staticClass:"notification-footer",class:{"bg-danger":"rejected"===t.state,"bg-success":"accepted"===t.state}},["pending"===t.state?s("div",{staticClass:"buttons text-right"},[s("button",{staticClass:"btn btn-outline-success btn-sm",on:{click:function(e){t.$emit("accept",t.index)}}},[t._v("\n                        accept\n                    ")]),t._v(" "),s("button",{staticClass:"btn btn-outline-danger btn-sm",on:{click:function(e){t.$emit("reject",t.index)}}},[t._v("\n                        reject\n                    ")])]):t._e(),t._v(" "),"rejected"===t.state?s("div",{staticClass:"text-right notification-sign"},[t._v("\n                    You rejected this invite\n                ")]):t._e(),t._v(" "),"accepted"===t.state?s("div",{staticClass:"text-right notification-sign"},[t._v("\n                    You accepted this invite\n                ")]):t._e()])])])])},staticRenderFns:[]},ft=s("VU/8")(ht,vt,!1,function(t){s("OMCm")},"data-v-10bf5098",null).exports,mt={name:"AddresseeListItem",props:{index:{type:Number},itemClickFunc:{type:Function,default:function(){}},user:{type:Object,default:function(){}}}},pt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row addressee-list-item",on:{click:function(e){t.itemClickFunc(t.index)}}},[s("div",{staticClass:"col-lg-1"},[s("img",{staticClass:"addressee-avatar rounded-circle",attrs:{src:t.user.avatarUrl}})]),t._v(" "),s("div",{staticClass:"col-lg-11"},[s("div",{staticClass:"addressee-username"},[t._v(t._s(t.user.username))]),t._v(" "),s("div",{staticClass:"addressee-id"},[t._v(t._s(t.user._id))])])])},staticRenderFns:[]},gt={name:"AddresseeList",props:["users","itemClickFunc"],components:{AddresseeListItem:s("VU/8")(mt,pt,!1,function(t){s("ELC4")},"data-v-14f2c151",null).exports}},Ct={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",{directives:[{name:"prevent-parent-scroll",rawName:"v-prevent-parent-scroll"}],staticClass:"addressee-list ww-box"},[s("transition-group",{attrs:{mode:"in-out",name:"addressee",tag:"div"}},t._l(t.users,function(e,i){return s("addressee-list-item",{key:e._id,staticClass:"addressee-list-item",attrs:{index:i,itemClickFunc:t.itemClickFunc,user:e}})}))],1)},staticRenderFns:[]},Tt=s("VU/8")(gt,Ct,!1,function(t){s("4Zhw")},"data-v-000140fb",null).exports,Et={name:"InputField",props:{fieldTitle:{type:String,default:"The title of the field"},fieldValue:{type:String,default:"The current value of the field"},titleInData:{type:String},url:{type:String,required:!0},validationRules:{type:String,required:!0},setter:{type:Function}},data:function(){return{field:"",id:Date.now()+Math.random(),showSign:!1}},computed:{isValid:function(){return this.errors.has("field")||""===this.field}},methods:{sendChanges:function(){var t=this;o.a.post(this.url,{field:this.field}).then(function(e){var s=e.data;console.log("data",t.fieldTitle),t.setter({field:t.titleInData,value:s[t.titleInData]}),t.field="",t.showSuccessSign()}).catch(function(t){return Q.pushError({message:"Cannot change field try again later!"})})},showSuccessSign:function(){var t=this;this.showSign=!0,setTimeout(function(){t.showSign=!1},2e3)}}},St={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"form-group"},[s("label",{staticClass:"field-label",class:{"text-danger":t.errors.has("field")},attrs:{for:t.id}},[t._v("\n            "+t._s(t.fieldTitle)+"\n        ")]),t._v(" "),s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.field,expression:"field"},{name:"validate",rawName:"v-validate.initial",value:t.field,expression:"field",modifiers:{initial:!0}}],staticClass:"form-control in",class:{"is-invalid":t.errors.has("field")},attrs:{"data-vv-rules":t.validationRules,placeholder:t.fieldValue,type:"email"},domProps:{value:t.field},on:{input:function(e){e.target.composing||(t.field=e.target.value)}}}),t._v(" "),s("span",{staticClass:"input-group-btn"},[s("button",{staticClass:"btn btn-secondary",attrs:{disabled:t.isValid},on:{click:t.sendChanges}},[t._v("\n                    Save\n                ")])])]),t._v(" "),s("transition",{attrs:{name:"danger-box"}},[t.errors.has("field")?s("p",{key:"1",staticClass:"text-danger"},[t._v(t._s(t.errors.first("field")))]):t._e(),t._v(" "),t.showSign?s("p",{key:"2",staticClass:"text-success"},[t._v("Successfully changed!")]):t._e()])],1)])},staticRenderFns:[]},At=s("VU/8")(Et,St,!1,function(t){s("XGrC")},"data-v-588810c4",null).exports,bt=s("rifk"),It=s.n(bt),Ot={name:"AddMembers",props:{members:{type:Array,default:function(){return[]}}},data:function(){return{showSuccess:!1}},computed:u()({},Object(_.c)({appState:"APP_G_GET_APP_STATE",chat:"CHAT_SETTINGS_G_GET_CHAT",inviteReceivers:"CHAT_SETTINGS_G_INVITE_RECEIVERS",users:"CHAT_SETTINGS_G_GET_USERS"})),watch:{chat:function(t){t._id&&this.getUsers()}},methods:u()({},Object(_.b)({getUsers:"CHAT_SETTINGS_A_FETCH_USERS",sendNotifications:"CHAT_SETTINGS_A_SEND_NOTIFICATIONS"}),Object(_.d)({pushInviteReceivers:"CHAT_SETTINGS_M_PUSH_INVITE_RECEIVERS",resetInviteReceivers:"CHAT_SETTINGS_M_RESET_INVITE_RECEIVERS",spliceInviteReceivers:"CHAT_SETTINGS_M_SPLICE_INVITE_RECEIVERS"}),{addInviteReceiver:function(t){this.pushInviteReceivers(this.users[t])},deleteInviteReceiver:function(t){this.spliceInviteReceivers(t)},sendNotificationsWrapper:function(){var t=this;this.sendNotifications(),this.showSuccess=!0,setTimeout(function(){t.showSuccess=!1},2500)}}),created:function(){this.appState&&this.chat._id&&this.getUsers()},beforeDestroy:function(){this.resetInviteReceivers()}},wt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"row"},[e("div",{staticClass:"col-lg-6 list"},[e("h6",{staticClass:"ml-2 mb-3"},[this._v("Users:")]),this._v(" "),e("addressee-list",{staticClass:"addressee-list",attrs:{itemClickFunc:this.addInviteReceiver,users:this.users}}),this._v(" "),e("p",{staticClass:"ml-2"},[this._v("Click on an item to add user in opposite list")])],1),this._v(" "),e("transition",{attrs:{name:"invited-slide",mode:"out-in"}},[this.showSuccess?this._e():e("div",{key:"1",staticClass:"col-lg-6 list"},[e("h6",{staticClass:"ml-2 mb-3"},[this._v("These users will receive an invite to your chat:")]),this._v(" "),e("addressee-list",{staticClass:"addressee-list",attrs:{itemClickFunc:this.deleteInviteReceiver,users:this.inviteReceivers}}),this._v(" "),e("p",{staticClass:"ml-2"},[this._v("Click on an item removes it from list")])],1),this._v(" "),this.showSuccess?e("div",{key:"2",staticClass:"col-lg-6 text-center success-sign"},[e("h6",{staticClass:"bg-success"},[this._v("The users successfully invited!")])]):this._e()]),this._v(" "),e("div",{staticClass:"col-lg-12 text-right"},[e("button",{staticClass:"btn btn-outline-info mr-2",on:{click:this.sendNotificationsWrapper}},[this._v("\n                Send invites\n            ")])])],1)])},staticRenderFns:[]},Nt=s("VU/8")(Ot,wt,!1,function(t){s("Xium")},"data-v-143a18d1",null).exports,Rt={name:"ChatTitleField",props:{fieldTitle:{type:String,default:"The title of the field"},fieldValue:{type:String,default:"The current value of the field"},titleInData:{type:String},validationRules:{type:String,required:!0},setter:{type:Function}},data:function(){return{field:"",id:Date.now()+Math.random(),showSign:!1}},computed:u()({},Object(_.c)({user:"SESSION_G_GET_CURRENT_USER"}),{isValid:function(){return this.errors.has("field")||""===this.field}}),methods:u()({},Object(_.b)({createChat:"SESSION_A_CREATE_CHAT"}),{createChatWrapper:function(){var t=this;this.createChat({data:{creator:this.user._id,title:this.field,type:"public"},cb:function(){t.$router.push("/chats")}})}})},Gt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("label",{staticClass:"field-label",class:{"text-danger":t.errors.has("field")},attrs:{for:t.id}},[t._v("\n        "+t._s(t.fieldTitle)+"\n    ")]),t._v(" "),s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.field,expression:"field"},{name:"validate",rawName:"v-validate.initial",value:t.field,expression:"field",modifiers:{initial:!0}}],staticClass:"form-control in",class:{"is-invalid":t.errors.has("field")},attrs:{"data-vv-rules":t.validationRules,placeholder:t.fieldValue,type:"email"},domProps:{value:t.field},on:{input:function(e){e.target.composing||(t.field=e.target.value)}}}),t._v(" "),s("span",{staticClass:"input-group-btn"},[s("button",{staticClass:"btn btn-secondary",attrs:{disabled:t.isValid},on:{click:t.createChatWrapper}},[t._v("\n                Create\n            ")])])]),t._v(" "),s("transition",{attrs:{name:"danger-box"}},[t.errors.has("field")?s("p",{staticClass:"text-danger"},[t._v("\n            "+t._s(t.errors.first("field"))+"\n        ")]):t._e()])],1)},staticRenderFns:[]},Ut={name:"ChatCreation",components:{ChatTitleField:s("VU/8")(Rt,Gt,!1,function(t){s("cPN+")},"data-v-aaaf3864",null).exports}},yt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"chat-create row ww-box"},[e("ww-header",{staticClass:"col-lg-12",attrs:{title:"Create a new chat"}}),this._v(" "),e("div",{staticClass:"chat-title col-lg-12 mt-3"},[e("chat-title-field",{attrs:{validationRules:"alpha_dash|chatExists",fieldValue:"Enter the title of the chat",fieldTitle:"Title of the chat"}})],1)],1)])},staticRenderFns:[]},Ft=s("VU/8")(Ut,yt,!1,function(t){s("bc/6")},"data-v-7857a6c2",null).exports,Lt={name:"ChatListItem",props:["chat"],computed:u()({},Object(_.c)({currentChat:"CHAT_G_GET_CHAT",user:"SESSION_G_GET_CURRENT_USER"})),methods:u()({},Object(_.b)({leaveChat:"CHATLIST_A_LEAVE_CHAT"}),{changeChat:function(){this.$router.push("/chats/"+this.chat._id)},goToChatSettings:function(){this.$router.push("/chats/"+this.chat._id+"/settings/members")}})},xt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chat-list-item",class:{"active-chat":t.chat._id===t.currentChat._id},on:{click:t.changeChat}},[s("div",{staticClass:"media"},[s("img",{staticClass:"mr-3 rounded",attrs:{src:t.chat.coverUrl,alt:"Generic placeholder image"}}),t._v(" "),s("div",{staticClass:"media-body"},[s("h5",{staticClass:"mt-0"},[t._v("\n                "+t._s(t.chat.title)+"\n                "),0!==t.chat.notifications?s("span",{staticClass:"badge badge-secondary"},[t._v("\n                    "+t._s(t.chat.notifications)+"\n                ")]):t._e()]),t._v(" "),s("h6",[t._v("Creator: "+t._s(t.chat.creator.username))])]),t._v(" "),s("div",{staticClass:"icons"},[s("button",{staticClass:"btn btn-outline-info btn-sm",on:{click:function(e){e.stopPropagation(),t.leaveChat(t.chat._id)}}},[s("i",{staticClass:"fa fa-sign-out",attrs:{"aria-hidden":"true"}})]),t._v(" "),s("button",{directives:[{name:"show",rawName:"v-show",value:t.chat.creator._id===t.user._id,expression:"chat.creator._id === user._id"}],staticClass:"btn btn-outline-info btn-sm",on:{click:function(e){e.stopPropagation(),t.goToChatSettings(e)}}},[s("i",{staticClass:"fa fa-bars",attrs:{"aria-hidden":"true"}})])])])])},staticRenderFns:[]},Mt=s("VU/8")(Lt,xt,!1,function(t){s("ZBC5")},"data-v-6eac0cea",null).exports,Ht={name:"ChatList",computed:u()({},Object(_.c)({appState:"APP_G_GET_APP_STATE",availableChats:"CHATLIST_G_GET_AVAILABLE_CHATS"})),components:{ChatListItem:Mt},watch:{appState:function(t){t&&this.getChatList()}},methods:u()({},Object(_.b)({getChatList:"CHATLIST_A_FETCH_AVAILABLE_CHATS"})),created:function(){this.appState&&this.getChatList()}},Vt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"chat-list-box ww-box"},[e("ww-header",{attrs:{title:"Chats"}}),this._v(" "),e("transition-group",{staticClass:"chat-list",attrs:{mode:"out-in",name:"item",tag:"div"}},this._l(this.availableChats,function(t,s){return e("chat-list-item",{key:s,staticClass:"chat-list-item",attrs:{chat:t}})})),this._v(" "),e("div",{staticClass:"add-chat-btn-wrapper"},[e("div",{staticClass:"text-center"},[e("router-link",{staticClass:"btn btn-info text-center add-chat-btn",attrs:{tag:"button",to:"/chats/create"}},[this._v("\n                    Add new chat\n                ")])],1)])],1)])},staticRenderFns:[]},kt=s("VU/8")(Ht,Vt,!1,function(t){s("NQ7S")},"data-v-150f6954",null).exports,Pt=s("4RJ8"),Dt=s.n(Pt),$t=s("1Wvq"),jt=s.n($t),Kt={name:"ChatCover",props:["chat"],components:{FileUpload:jt.a},data:function(){return{cropper:!1,edit:!1,files:[]}},computed:u()({},Object(_.c)({token:"LOCAL_STORAGE_G_GET_TOKEN"})),watch:{edit:function(t){t?this.$nextTick(function(){if(this.$refs.editImage){var t=new Dt.a(this.$refs.editImage,{aspectRatio:1,viewMode:1});this.cropper=t}}):this.cropper&&(this.cropper.destroy(),this.cropper=!1)}},methods:u()({},Object(_.d)({setFieldChatList:"CHATLIST_M_SET_FIELD_OF_CHAT",setFieldChatSettings:"CHAT_SETTINGS_M_SET_FIELD"}),{uploadedHook:function(){var t=this;this.chat._id&&o.a.get("/private/chats/"+this.chat._id).then(function(e){var s=e.data;t.setFieldChatList({id:t.chat._id,changes:{field:"coverUrl",value:s.coverUrl}}),t.setFieldChatSettings({field:"coverUrl",value:s.coverUrl})}).catch()},editSave:function(){this.edit=!1;for(var t=this.files[0],e=atob(this.cropper.getCroppedCanvas().toDataURL(t.type).split(",")[1]),s=new Uint8Array(e.length),i=0;i<e.length;i++)s[i]=e.charCodeAt(i);var a=new File([s],t.name,{type:t.type});this.$refs.upload.update(t.id,{file:a,type:a.type,size:a.size,active:!0})},alert:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){alert(t)}),inputFile:function(t,e,s){t&&!e&&this.$nextTick(function(){this.edit=!0}),!t&&e&&(this.edit=!1)},inputFilter:function(t,e,s){if(t&&!e&&!/\.(gif|jpg|jpeg|png|webp)$/i.test(t.name))return this.alert("Your choice is not a picture"),s();if(t&&(!e||t.file!==e.file)){t.url="";var i=window.URL||window.webkitURL;i&&i.createObjectURL&&(t.url=i.createObjectURL(t.file))}}})},Wt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"example-avatar"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.$refs.upload&&t.$refs.upload.dropActive,expression:"$refs.upload && $refs.upload.dropActive"}],staticClass:"drop-active"},[s("h3",[t._v("Drop files to upload")])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.edit,expression:"!edit"}],staticClass:"avatar-upload"},[s("div",{staticClass:"text-center p-2"},[s("label",{attrs:{for:"avatar"}},[s("img",{staticClass:"rounded",attrs:{src:t.files.length?t.files[0].url:t.chat.coverUrl}})])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-lg-12 avatar-info"},[t._m(0,!1,!1),t._v(" "),s("div",{staticClass:"p-2"},[s("file-upload",{ref:"upload",staticClass:"btn btn-secondary",attrs:{extensions:"gif,jpg,jpeg,png,webp",accept:"image/png,image/gif,image/jpeg,image/webp",name:"cover",id:"avatar","post-action":"private/chats/cover/"+t.chat._id,drop:!t.edit,headers:{authorization:t.token}},on:{"input-filter":t.inputFilter,"input-file":t.inputFile},model:{value:t.files,callback:function(e){t.files=e},expression:"files"}},[t._v("\n                        Upload avatar\n                    ")])],1)])])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.files.length&&t.edit,expression:"files.length && edit"}],staticClass:"avatar-edit"},[t.files.length?s("div",{staticClass:"avatar-edit-image"},[s("img",{ref:"editImage",attrs:{src:t.files[0].url}})]):t._e(),t._v(" "),s("div",{staticClass:"text-center p-4"},[s("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:function(e){e.preventDefault(),t.$refs.upload.clear(e)}}},[t._v("Cancel")]),t._v(" "),s("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(e){e.preventDefault(),t.editSave(e)}}},[t._v("Save")]),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:t.$refs.upload&&t.$refs.upload.uploaded,expression:"$refs.upload && $refs.upload.uploaded"}]},[t._v(t._s(t.uploadedHook()))])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h6",[this._v("Click the button or simply drop an image there to change the cover")])])}]},qt=s("VU/8")(Kt,Wt,!1,function(t){s("QNsw")},null,null).exports,Bt={name:"ChatSettings",computed:u()({},Object(_.c)({appState:"APP_G_GET_APP_STATE",chat:"CHAT_SETTINGS_G_GET_CHAT"})),components:{ChatCover:qt},watch:{appState:function(t){t&&this.getChat(this.$route.params.id)}},methods:u()({},Object(_.d)({setFieldChatList:"CHATLIST_M_SET_FIELD_OF_CHAT",setFieldChatSettings:"CHAT_SETTINGS_M_SET_FIELD"}),Object(_.b)({getChat:"CHAT_SETTINGS_A_FETCH_CHAT"}),{setChanges:function(t){this.setFieldChatList({id:this.chat._id,changes:t}),this.setFieldChatSettings(t)}}),created:function(){this.appState&&this.getChat(this.$route.params.id)}},zt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ww-box"},[e("div",{staticClass:"profile row "},[e("ww-header",{staticClass:"col-lg-12",attrs:{title:"Chat settings"}}),this._v(" "),e("div",{staticClass:"col-lg-5 avatar text-center"},[e("chat-cover",{attrs:{chat:this.chat}})],1),this._v(" "),e("div",{staticClass:"col-lg-7"},[e("h4",{staticClass:"text-center mt-5 text-secondary"},[this._v(this._s(this.chat.title))]),this._v(" "),e("input-field",{attrs:{fieldValue:this.chat.title,setter:this.setChanges,url:"/private/chats/change/"+this.chat._id+"/title",fieldTitle:"Change title",titleInData:"title",validationRules:"alpha_dash"}})],1),this._v(" "),e("div",{staticClass:"col-lg-12"},[e("ul",{staticClass:"nav"},[e("li",{staticClass:"nav-item"},[e("router-link",{staticClass:"nav-link",attrs:{to:"/chats/"+this.chat._id+"/settings/members","active-class":"text-info",exact:"",tag:"a"}},[this._v("\n                        Members\n                    ")])],1),this._v(" "),e("li",{staticClass:"nav-item"},[e("router-link",{staticClass:"nav-link",attrs:{to:"/chats/"+this.chat._id+"/settings/members/add","active-class":"text-info",tag:"a"}},[this._v("\n                        Add Members\n                    ")])],1)]),this._v(" "),e("hr")])],1),this._v(" "),e("div",{staticClass:"row justify-content-center"},[e("transition",{attrs:{name:"side",mode:"out-in"}},[e("router-view",{staticClass:"col-lg-11 router-view",attrs:{invites:this.chat.invites,members:this.chat.members}})],1)],1)])},staticRenderFns:[]},Yt=s("VU/8")(Bt,zt,!1,function(t){s("v5Eq")},"data-v-3afca033",null).exports,Jt={name:"Home",computed:u()({},Object(_.c)({user:"SESSION_G_GET_CURRENT_USER"}))},Zt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h1",[this._v("Welcome to WEREWOLF")]),this._v(" "),e("hr"),this._v(" "),e("h3",[this._v("Dear "),this.user.username?e("span",[this._v(this._s(this.user.username))]):e("span",[this._v("guest!")])])])},staticRenderFns:[]},Xt=s("VU/8")(Jt,Zt,!1,function(t){s("CztN")},null,null).exports,Qt={name:"ChatMembers",props:{members:{type:Array,default:function(){return[]}}},computed:u()({},Object(_.c)({invited:"CHAT_SETTINGS_G_INVITED"}))},te={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"row no-gutters"},[e("div",{staticClass:"col-lg-6"},[e("addressee-list",{staticClass:"list",attrs:{users:this.members}})],1),this._v(" "),e("div",{staticClass:"col-lg-6"},[e("addressee-list",{staticClass:"list",attrs:{users:this.invited}})],1)])])},staticRenderFns:[]},ee=s("VU/8")(Qt,te,!1,function(t){s("P5kM")},"data-v-5af0db58",null).exports,se={render:function(){var t=this.$createElement,e=this._self._c||t;return this.typingUsers&&this.typingUsers.length>0?e("div",{staticClass:"typing-users text-left"},[e("div",{staticClass:"ml-2 string"},[this._v(this._s(this.string))])]):this._e()},staticRenderFns:[]},ie={name:"MessageEditor",props:["chat"],data:function(){return{isTyping:!1,showUsersList:!1}},computed:{message:{get:function(){return this.$store.getters.CHAT_G_GET_NEW_MESSAGE},set:function(t){return this.$store._mutations.CHAT_M_SET_NEW_MESSAGE[0](t)}}},components:{TypingUsers:s("VU/8")({name:"TypingUsers",props:["typingUsers"],computed:{string:function(){var t=this;if(this.typingUsers){var e=this.$store.getters.SESSION_G_GET_CURRENT_USER,s=void 0;if(this.typingUsers.forEach(function(s,i){s===e.username&&t.typingUsers.splice(i,1)}),s=this.typingUsers.length>2?"and "+(this.typingUsers.length-2)+" others":"",1===this.typingUsers.length)return this.typingUsers[0]+" is typing now ";if(this.typingUsers.length>1)return this.typingUsers[0]+", "+this.typingUsers[1]+" "+s+" are typing now "}}}},se,!1,function(t){s("89aD")},"data-v-15be044c",null).exports},watch:{isTyping:function(t){this.changeTypingState(t)}},methods:u()({},Object(_.b)({changeTypingState:"CHAT_A_CHANGE_TYPING_STATE",sendMessage:"CHAT_A_SEND_MESSAGE"}),{addAddressee:function(t){this.message="@"+this.chat.members[t]._id+"("+this.chat.members[t].username+"):",this.inputHandler()},inputHandler:function(){this.showUsersList="@"===this.message},sendMessageWrapper:function(){var t=this.message.indexOf(":"),e=this.message.slice(0,t);""!==this.message&&""!==this.message.slice(t+1)?(e.match(/^@[a-zA-Z0-9]{24}\([a-zA-Z0-9_]{1,16}\)$/)?this.sendMessage({content:this.message.slice(t+1),target:e.slice(1,25),type:"private"}):this.sendMessage({content:this.message,type:"public"}),this.isTyping=!1):Q.pushError({message:"You can't send an empty message"})}})},ae={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"editor-wrapper row no-gutters justify-content-center"},[t.showUsersList?s("addressee-list",{staticClass:"addressee-list col-lg-10",attrs:{itemClickFunc:t.addAddressee,users:t.chat.members}}):t._e(),t._v(" "),s("typing-users",{staticClass:"typing-users col-lg-10",attrs:{typingUsers:t.chat.typingUsers}}),t._v(" "),s("div",{staticClass:"col-lg-9"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],staticClass:"form-control editor ww-box",attrs:{id:"messageEditor",rows:"3"},domProps:{value:t.message},on:{change:function(e){t.isTyping=!1},input:[function(e){e.target.composing||(t.message=e.target.value)},t.inputHandler],keydown:function(e){t.isTyping=!0},leavefocus:function(e){t.isTyping=!1}}})]),t._v(" "),s("div",{staticClass:"send-button-wrapper col-lg-1"},[s("button",{staticClass:"btn btn-outline-info send-button",on:{click:t.sendMessageWrapper}},[s("i",{staticClass:"fa fa-paper-plane",attrs:{"aria-hidden":"true"}})])])],1)])},staticRenderFns:[]},ne=s("VU/8")(ie,ae,!1,function(t){s("WCsC")},"data-v-7cda5f5c",null).exports,re={name:"ChatMessage",props:{isAuthor:{type:Boolean,default:!1},isPrivate:{type:Boolean,default:!1},privateTarget:{type:Boolean,default:!1},message:{type:Object,default:function(){}}}},oe={render:function(){var t=this.$createElement,e=this._self._c||t;return this.isPrivate&&this.privateTarget||this.isAuthor||!this.isPrivate?e("div",["system"===this.message.type?e("div",{staticClass:"col-lg-12"},[e("div",{staticClass:"row bg-secondary text-light"},[e("div",{staticClass:"col-lg-12 text-center"},[this._v("\n                "+this._s(this.message.content)+" ("+this._s(this.message.target.username)+")\n            ")])])]):e("div",{staticClass:"col-lg-5"},[e("div",{staticClass:"row"},[this.message.sameUser?this._e():e("div",{staticClass:"col-lg-12 image-wrapper"},[e("img",{staticClass:"rounded-circle",attrs:{src:this.message.author.avatarUrl,height:"30px"}})]),this._v(" "),this.message.sameUser?this._e():e("div",{staticClass:"col-lg-12"}),this._v(" "),this.message.sameUser?this._e():e("div",{staticClass:"user-info col-lg-12"},[this._v("\n                "+this._s(this.message.author.username)+"\n            ")]),this._v(" "),e("div",{staticClass:"col-lg-12 divider"}),this._v(" "),e("div",{staticClass:"message col-lg-12",class:{"current-user-message":this.isAuthor&&!this.isPrivate,"private-message":this.isPrivate}},[this.isPrivate&&this.isAuthor?e("span",[this._v("\n                    to "),e("span",{staticClass:"target"},[this._v(" "+this._s(this.message.target.username))]),this._v(" "),e("br")]):this._e(),this._v("\n\n                "+this._s(this.message.content)+"\n\n                "),e("div",{style:{color:"rgba(160, 160, 160, 1)"}},[this._v("\n                    "+this._s(this._f("timestamp")(this.message.timestamp))+"\n                ")])])])])]):this._e()},staticRenderFns:[]},ce=s("VU/8")(re,oe,!1,function(t){s("LVhj")},"data-v-9dd621e8",null).exports,le={name:"MessageBox",computed:u()({},Object(_.c)({appState:"APP_G_GET_APP_STATE",chat:"CHAT_G_GET_CHAT",currentUser:"SESSION_G_GET_CURRENT_USER",scrollEvent:"CHAT_G_GET_SCROLL_EVENT"})),watch:{$route:function(t,e){this.beforeLeaveChat(),this.getChat(t.params.id)},appState:function(t){t&&this.getChat(this.$route.params.id)},scrollEvent:function(t){var e=this;t&&setTimeout(function(){var t=e.$el.querySelector("#messageList"),s=t.lastElementChild.previousElementSibling.lastElementChild,i=0;if(t.scrollTop+s.offsetHeight+s.previousElementSibling.offsetHeight+t.clientHeight>=t.scrollHeight)var a=setInterval(function(){t.scrollHeight-t.clientHeight===t.scrollTop&&clearInterval(a),++i,t.scrollTop=t.scrollTop+10},30)},100)}},methods:u()({},Object(_.b)({beforeLeaveChat:"CHAT_A_BEFORE_LEAVE_CHAT",getChat:"CHAT_A_FETCH_CHAT"})),components:{Editor:ne,Message:ce},beforeRouteLeave:function(t,e,s){this.beforeLeaveChat(),s()},created:function(){this.appState&&this.getChat(this.$route.params.id)}},de={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"chat-box ww-box"},[t.chat._id?s("ww-header",{attrs:{title:t.chat.title}}):t._e(),t._v(" "),t.chat?s("div",{directives:[{name:"prevent-parent-scroll",rawName:"v-prevent-parent-scroll"}],staticClass:"message-list",attrs:{id:"messageList"}},[s("transition-group",{staticClass:"transition-group-message",attrs:{name:"message",tag:"div"}},t._l(t.chat.messages,function(e){return s("message",{key:e._id,staticClass:"row message-list-item",class:{"justify-content-end":e.author._id===t.currentUser._id},attrs:{id:e._id,isAuthor:e.author._id===t.currentUser._id,isPrivate:"private"===e.type,message:e,privateTarget:e.target&&e.target._id===t.currentUser._id}})})),t._v(" "),s("div",{staticClass:"placeholder"})],1):t._e(),t._v(" "),s("hr"),t._v(" "),t.chat?s("editor",{staticClass:"textarea",attrs:{chat:t.chat,online:t.chat.online}}):t._e(),t._v(" "),s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-lg-10",staticStyle:{"font-size":"11px"}},[t.chat.onlineUsers?s("div",[t._v("online: "+t._s(t.chat.onlineUsers.length)+" / "+t._s(t.chat.members.length))]):t._e(),t._v(" "),s("div",[t._v(" online: "),t._l(t.chat.onlineUsers,function(e){return s("span",[t._v(t._s(e.username)+" | ")])})],2),t._v(" "),s("div",[t._v(" members: "),t._l(t.chat.members,function(e){return s("span",[t._v(" "+t._s(e.username)+" | ")])})],2)])])],1)])},staticRenderFns:[]},ue=s("VU/8")(le,de,!1,function(t){s("4EmT")},"data-v-43b85423",null).exports,_e={name:"NotificationBox",computed:u()({},Object(_.c)({user:"SESSION_G_GET_CURRENT_USER"}),{notifications:{set:function(t){this.user.notifications=t.reverse()},get:function(){return this.user.notifications.reverse()}}}),methods:u()({},Object(_.b)({joinChat:"SESSION_A_JOIN_CHAT"}),{accept:function(t){this.sendAnswer("/private/notifications/"+this.user.notifications[t]._id+"/accept",t,!0)},reject:function(t){this.sendAnswer("/private/notifications/"+this.user.notifications[t]._id+"/reject",t,!1)},sendAnswer:function(t,e,s){var i=this;o.a.post(t,this.user.notifications[e]).then(function(t){var a=t.data;i.user.notifications[e].state=a.state,s&&i.joinChat(i.user.notifications[e].chat)}).catch(function(t){Q.pushError({message:"It's something wrong. We fucked up. Try again later"})})}})},he={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"notification-box ww-box"},[s("ww-header",{attrs:{title:"Notifications"}}),t._v(" "),s("div",{staticClass:"notifications"},[s("transition-group",{attrs:{name:"notification",tag:"div"}},t._l(t.user.notifications,function(e,i){return s("ww-notification",{key:i,staticClass:"ww-box ww-notification",attrs:{content:e.content,index:i,state:e.state,title:e.title},on:{accept:t.accept,reject:t.reject}})}))],1)],1)])},staticRenderFns:[]},ve=s("VU/8")(_e,he,!1,function(t){s("BqhT")},"data-v-688d5ab2",null).exports,fe={props:["user"],components:{FileUpload:jt.a},data:function(){return{files:[],edit:!1,cropper:!1}},computed:u()({},Object(_.c)({token:"LOCAL_STORAGE_G_GET_TOKEN"})),watch:{edit:function(t){t?this.$nextTick(function(){if(this.$refs.editImage){var t=new Dt.a(this.$refs.editImage,{aspectRatio:1,viewMode:1});this.cropper=t}}):this.cropper&&(this.cropper.destroy(),this.cropper=!1)}},methods:u()({},Object(_.d)({setField:"SESSION_M_SET_FIELD"}),{uploadedHook:function(){var t=this;o.a.get("/private/users/"+this.user._id).then(function(e){var s=e.data;t.setField({field:"avatarUrl",value:s.avatarUrl})}).catch()},editSave:function(){this.edit=!1;for(var t=this.files[0],e=atob(this.cropper.getCroppedCanvas().toDataURL(t.type).split(",")[1]),s=new Uint8Array(e.length),i=0;i<e.length;i++)s[i]=e.charCodeAt(i);var a=new File([s],t.name,{type:t.type});this.$refs.upload.update(t.id,{file:a,type:a.type,size:a.size,active:!0})},alert:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){alert(t)}),inputFile:function(t,e,s){t&&!e&&this.$nextTick(function(){this.edit=!0}),!t&&e&&(this.edit=!1)},inputFilter:function(t,e,s){if(t&&!e&&!/\.(gif|jpg|jpeg|png|webp)$/i.test(t.name))return this.alert("Your choice is not a picture"),s();if(t&&(!e||t.file!==e.file)){t.url="";var i=window.URL||window.webkitURL;i&&i.createObjectURL&&(t.url=i.createObjectURL(t.file))}}})},me={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"example-avatar"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.$refs.upload&&t.$refs.upload.dropActive,expression:"$refs.upload && $refs.upload.dropActive"}],staticClass:"drop-active"},[s("h3",[t._v("Drop files to upload")])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.edit,expression:"!edit"}],staticClass:"avatar-upload"},[s("div",{staticClass:"text-center p-2"},[s("label",{attrs:{for:"avatar"}},[s("img",{staticClass:"rounded-circle",attrs:{src:t.files.length?t.files[0].url:t.user.avatarUrl}})])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-lg-12 avatar-info"},[t._m(0,!1,!1),t._v(" "),s("div",{staticClass:"p-2"},[s("file-upload",{ref:"upload",staticClass:"btn btn-secondary",attrs:{extensions:"gif,jpg,jpeg,png,webp",accept:"image/png,image/gif,image/jpeg,image/webp",name:"avatar",id:"avatar","post-action":"private/users/avatar",drop:!t.edit,headers:{authorization:t.token}},on:{"input-filter":t.inputFilter,"input-file":t.inputFile},model:{value:t.files,callback:function(e){t.files=e},expression:"files"}},[t._v("\n                        Upload avatar\n                    ")])],1)])])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.files.length&&t.edit,expression:"files.length && edit"}],staticClass:"avatar-edit"},[t.files.length?s("div",{staticClass:"avatar-edit-image"},[s("img",{ref:"editImage",attrs:{src:t.files[0].url}})]):t._e(),t._v(" "),s("div",{staticClass:"text-center p-4"},[s("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:function(e){e.preventDefault(),t.$refs.upload.clear(e)}}},[t._v("Cancel")]),t._v(" "),s("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(e){e.preventDefault(),t.editSave(e)}}},[t._v("Save")]),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:t.$refs.upload&&t.$refs.upload.uploaded,expression:"$refs.upload && $refs.upload.uploaded"}]},[t._v(t._s(t.uploadedHook()))])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h4",[this._v("Click the button or simply drop an image there to change the avatar")])])}]},pe=s("VU/8")(fe,me,!1,function(t){s("I+gA")},null,null).exports,ge={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"user-profile"},[e("div",{staticClass:"row justify-content-center"},[e("div",{staticClass:"col-lg-10"},[e("ul",{staticClass:"nav text-center"},[e("li",{staticClass:"nav-item"},[e("router-link",{staticClass:"nav-link",attrs:{tag:"a","active-class":"text-info",to:"/profile",exact:""}},[this._v("Profile")])],1),this._v(" "),e("li",{staticClass:"nav-item"},[e("router-link",{staticClass:"nav-link",attrs:{tag:"a","active-class":"active",to:"/profile/edit",exact:""}},[this._v("Edit")])],1)])]),this._v(" "),e("div",{staticClass:"col-lg-10"},[e("hr"),this._v(" "),e("div",{staticClass:"profile-field"},[e("h5",[this._v("First name")]),this._v(" "),e("p",[this._v(this._s(this.user.firstName))])]),this._v(" "),e("div",{staticClass:"profile-field"},[e("h5",[this._v("Last name")]),this._v(" "),e("p",[this._v(this._s(this.user.lastName))])]),this._v(" "),e("div",{staticClass:"profile-field"},[e("h5",[this._v("Username")]),this._v(" "),e("p",[this._v(this._s(this.user.username))])]),this._v(" "),e("div",{staticClass:"profile-field"},[e("h5",[this._v("Email")]),this._v(" "),e("p",[this._v(this._s(this.user.email))])]),this._v(" "),e("div",{staticClass:"profile-field"},[e("h5",[this._v("Phone")]),this._v(" "),e("p",[this._v(this._s(this.user.phone))])])])])])},staticRenderFns:[]},Ce=s("VU/8")({name:"UserProfile",props:["user"]},ge,!1,function(t){s("qDIe")},"data-v-24aa2f26",null).exports,Te={name:"Profile",computed:u()({},Object(_.c)({user:"SESSION_G_GET_CURRENT_USER"})),components:{ProfileAvatar:pe,UserProfile:Ce}},Ee={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"profile row ww-box"},[e("ww-header",{staticClass:"col-lg-12",attrs:{title:"Profile"}}),this._v(" "),e("div",{staticClass:"col-lg-5 avatar text-center"},[e("profile-avatar",{attrs:{user:this.user}})],1),this._v(" "),e("transition",{attrs:{name:"side",mode:"out-in"}},[e("router-view",{staticClass:"col-lg-7 router-view",attrs:{user:this.user}})],1)],1)])},staticRenderFns:[]},Se=s("VU/8")(Te,Ee,!1,function(t){s("6tpM")},"data-v-704b93ec",null).exports,Ae={props:["user"],methods:u()({},Object(_.d)({setField:"SESSION_M_SET_FIELD"}))},be={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"profile-edit"},[e("div",{staticClass:"row justify-content-center"},[e("div",{staticClass:"col-lg-10"},[e("ul",{staticClass:"nav text-center"},[e("li",{staticClass:"nav-item"},[e("router-link",{staticClass:"nav-link",attrs:{tag:"a","active-class":"text-info",to:"/profile",exact:""}},[this._v("Profile")])],1),this._v(" "),e("li",{staticClass:"nav-item"},[e("router-link",{staticClass:"nav-link",attrs:{tag:"a","active-class":"text-info",to:"/profile/edit"}},[this._v("Edit")])],1)])]),this._v(" "),e("div",{staticClass:"col-lg-10"},[e("hr"),this._v(" "),e("input-field",{attrs:{fieldValue:this.user.firstName,setter:this.setField,fieldTitle:"First name",titleInData:"firstName",url:"/private/users/change/firstName",validationRules:"alpha_spaces"}}),this._v(" "),e("input-field",{attrs:{fieldValue:this.user.lastName,setter:this.setField,fieldTitle:"Last name",titleInData:"lastName",url:"/private/users/change/lastName",validationRules:"alpha_spaces"}}),this._v(" "),e("input-field",{attrs:{fieldValue:this.user.username,setter:this.setField,fieldTitle:"Username",titleInData:"username",url:"/private/users/change/username",validationRules:"alpha_dash|usernameExists"}}),this._v(" "),e("input-field",{attrs:{fieldValue:this.user.email,setter:this.setField,fieldTitle:"Email",titleInData:"email",url:"/private/users/change/email",validationRules:"email|emailExists"}}),this._v(" "),e("input-field",{attrs:{fieldValue:this.user.phone,setter:this.setField,fieldTitle:"Phone",titleInData:"phone",url:"/private/users/change/phone",validationRules:"numeric|max:12"}})],1)])])},staticRenderFns:[]},Ie=function(t,e,s){console.log("beforeEnter",t),console.log("beforeEnter",e);var i=JSON.parse(localStorage.getItem("data"));i&&null!==i.token?s():(s(!1),Q.pushError({message:"Only authorized users can access route"}))},Oe=[{path:"",components:{default:Xt}},{path:"/chats",component:kt,beforeEnter:Ie},{path:"/chats/:id/settings",component:Yt,children:[{path:"/chats/:id/settings/members",component:ee},{path:"/chats/:id/settings/members/add",component:Nt}],beforeEnter:Ie},{path:"/chats/create",component:Ft,beforeEnter:Ie},{path:"/chats/:id",component:ue,beforeEnter:Ie},{path:"/notifications",component:ve,beforeEnter:Ie},{path:"/profile",components:{default:Se},children:[{path:"",component:Ce},{path:"edit",component:s("VU/8")(Ae,be,!1,function(t){s("FGnn")},"data-v-17a04360",null).exports}],beforeEnter:Ie},{path:"*",redirect:"/"}],we={state:{appState:!1},mutations:{APP_M_SET_READY_STATE:function(t,e){t.appState=!0}},actions:{APP_A_INIT_APP:function(t){t.commit;var e=t.dispatch;t.state,e("LOCAL_STORAGE_A_INIT_STORAGE"),e("SOCKET_IO_A_INIT_SOCKETS")}},getters:{APP_G_GET_APP_STATE:function(t){return t.appState}}},Ne=[{id:1,name:"Rolls-Royce",price:"200"},{id:2,name:"Goggle",price:"467"},{id:3,name:"Amazon",price:"350"},{id:4,name:"Microsoft",price:"377"}],Re={state:{stocks:[]},mutations:{SET_STOCKS:function(t,e){t.stocks=e},RND_STOCKS:function(t){t.stocks.forEach(function(t){t.price=Math.round(t.price*(1+Math.random()-.5))})}},actions:{buyStock:function(t,e){(0,t.commit)("BUY_STOCKS",e)},initStocks:function(t){(0,t.commit)("SET_STOCKS",Ne)},randomizeStocks:function(t){(0,t.commit)("RND_STOCKS",Ne)}},getters:{stocks:function(t){return t.stocks}}},Ge={state:{funds:1e4,stocksP:[]},mutations:{BUY_STOCKS:function(t,e){var s=e.stockId,i=e.quantity,a=e.stockPrice,n=t.stocksP.find(function(t){return t.id===s});n?n.quantity+=Number(i):t.stocksP.push({id:s,quantity:Number(i)}),t.funds-=a*i},SELL_STOCKS:function(t,e){var s=e.stockId,i=e.quantity,a=e.stockPrice,n=t.stocksP.find(function(t){return t.id===s});n.quantity>i?n.quantity-=i:t.stocksP.splice(t.stocksP.indexOf(n)),t.funds+=a*i}},actions:{sellStock:function(t,e){(0,t.commit)("SELL_STOCKS",e)}},getters:{stockPortfolio:function(t,e){return t.stocksP.map(function(t){var s=e.stocks.find(function(e){return console.log("elem",e),console.log("stock",t),e.id===t.id});return console.log("record",s),{id:t.id,quantity:t.quantity,name:s.name,price:s.price}})},funds:function(t){return t.funds}}},Ue={state:{chatFetched:!1,currentChat:{_id:null,members:[],onlineUsers:[],messages:[]},newMessage:"",previousChatId:null,scrollEvent:!1},mutations:{CHAT_M_ADD_MESSAGE:function(t,e){t.currentChat.messages.push(e),t.scrollEvent=!0,setTimeout(function(){t.scrollEvent=!1},100)},CHAT_M_RESET_CHAT:function(t){t.previousChatId=t.currentChat._id,t.currentChat={},t.newMessage="",t.chatFetched=!1},CHAT_M_SCROLL:function(t,e){t.scrollHandler=!0,setTimeout(function(){t.scrollHandler=!1},100)},CHAT_M_SET_NEW_MESSAGE:function(t,e){t.newMessage=e},CHAT_M_SET_ONLINE_USERS:function(t,e){console.log("chat. set online users"),t.currentChat.onlineUsers=e},CHAT_M_SET_TYPING_USERS:function(t,e){t.currentChat.typingUsers=e}},actions:{CHAT_A_BEFORE_LEAVE_CHAT:function(t){var e=t.state,s=t.commit,i=(t.dispatch,t.getters,JSON.parse(localStorage.getItem("data"))),a=e.currentChat._id;i.chats[a]?(i.chats[a].message=e.newMessage,e.currentChat.messages[e.currentChat.messages.length-1]&&(i.chats[a].lastMessage=e.currentChat.messages[e.currentChat.messages.length-1]._id)):i.chats[a]={message:e.newMessage},localStorage.setItem("data",l()(i)),s("CHAT_M_RESET_CHAT")},CHAT_A_CHANGE_TYPING_STATE:function(t,e){var s=t.getters.SOCKET_IO_G_GET_MESSAGES_SOCKET;e?s.emit("beginTyping",{}):s.emit("finishTyping",{})},CHAT_A_FETCH_CHAT:function(t,e){var s=t.state,i=t.dispatch;o.a.get("/private/chats/"+e).then(function(t){var e=t.data;i("CHAT_A_SET_CHAT",e),s.chatFetched=!0}).catch(function(t){Q.pushError({message:"Cannot get chat!"})})},CHAT_A_SEND_MESSAGE:function(t,e){var s=t.getters,i=t.commit;s.SOCKET_IO_G_GET_MESSAGES_SOCKET.emit("message",e),i("CHAT_M_SET_NEW_MESSAGE","")},CHAT_A_SET_CHAT:function(t,e){var s=t.state,i=t.getters,a=t.commit,n=i.SOCKET_IO_G_GET_MESSAGES_SOCKET,r=JSON.parse(localStorage.getItem("data")).chats;e.messages=e.messages.map(function(t,s){var i=e.messages[s-1];if(i&&t){if("system"===i.type||"system"===t.type)return console.log("system",t),t;i.author._id===t.author._id&&(t.sameUser=!0)}return t}),e.typingUsers=[],e.onlineUsers=[],n.emit("changeChat",{currentChat:e._id,previousChat:s.previousChatId}).emit("typingUsers",{}).emit("users.online",{id:e._id}),s.currentChat=e,r[e._id]&&r[e._id].message&&a("CHAT_M_SET_NEW_MESSAGE",r[e._id].message),a("CHATLIST_M_RESET_NOTIFICATIONS",e._id)}},getters:{CHAT_G_GET_CHAT:function(t){return t.currentChat},CHAT_G_GET_NEW_MESSAGE:function(t){return t.newMessage},CHAT_G_GET_SCROLL_EVENT:function(t){return t.scrollEvent}}},ye=s("Gu7T"),Fe=s.n(ye),Le={state:{availableChats:[],storedNotifications:{}},mutations:{CHATLIST_M_SET_AVAILABLE_CHATS:function(t,e){e.forEach(function(e){t.storedNotifications[e._id]?e.notifications=t.storedNotifications[e._id]:e.notifications=0}),t.availableChats=e},CHATLIST_M_ADD_NOTIFICATION:function(t,e){t.availableChats.forEach(function(t){t._id===e.chat&&(t.notifications+=1)})},CHATLIST_M_RESET_NOTIFICATIONS:function(t,e){t.availableChats.forEach(function(t){t._id===e&&(t.notifications=0)})},CHATLIST_M_SET_FIELD_OF_CHAT:function(t,e){t.availableChats.forEach(function(t){t._id===e.id&&(t[e.changes.field]=e.changes.value)})},CHATLIST_M_STORE_NOTIFICATIONS:function(t){var e=t.availableChats;0!==e.length&&e.forEach(function(e){t.storedNotifications[e._id]=e.notifications})},CHATLIST_M_PULL_AVAILABLE_CHATS:function(t,e){t.availableChats=t.availableChats.filter(function(t){return t._id!==e})}},actions:{CHATLIST_A_FETCH_AVAILABLE_CHATS:function(t,e){var s=t.commit,i=t.getters;s("CHATLIST_M_STORE_NOTIFICATIONS"),o.a.post("/private/chats/available",i.SESSION_G_GET_CURRENT_USER.availableChats).then(function(t){var e=t.data;s("CHATLIST_M_SET_AVAILABLE_CHATS",e)}).catch(function(t){Q.pushError({message:"Can't load chat list, try again later."})})},CHATLIST_A_LEAVE_CHAT:function(t,e){t.commit;t.getters.SOCKET_IO_G_GET_MESSAGES_SOCKET.emit("chat.leave",{chatID:e})},CHATLIST_A_PUSH_AVAILABLE_CHATS:function(t,e){var s=t.state,i=t.commit,a=[].concat(Fe()(s.availableChats));a.push(e),i("CHATLIST_M_SET_AVAILABLE_CHATS",a)}},getters:{CHATLIST_G_GET_AVAILABLE_CHATS:function(t){return t.availableChats},CHATLIST_G_GET_COUNT_OF_NOTIFICATIONS:function(t){var e=0;return t.availableChats.forEach(function(t){e+=t.notifications}),e}}},xe={state:{dataLS:null},mutations:{LOCAL_STORAGE_M_STORE_DATA:function(t){localStorage.setItem("data",l()(t.dataLS))},LOCAL_STORAGE_M_RESTORE_DATA:function(t){t.dataLS=JSON.parse(localStorage.getItem("data"))}},actions:{LOCAL_STORAGE_A_INIT_STORAGE:function(t){var e=t.commit;localStorage.data||localStorage.setItem("data",l()({token:null,chats:{}})),e("LOCAL_STORAGE_M_RESTORE_DATA")},LOCAL_STORAGE_A_SET_TOKEN:function(t,e){var s=t.state,i=t.commit;s.dataLS.token=e,i("LOCAL_STORAGE_M_STORE_DATA"),i("LOCAL_STORAGE_M_RESTORE_DATA")},LOCAL_STORAGE_A_SET_MESSAGE:function(t,e){var s=t.commit,i=t.state,a=e.chat,n=e.message;i.dataLS.chats[a]||(i.dataLS.chats[a]={}),i.dataLS.chats[a].message=n,s("LOCAL_STORAGE_M_STORE_DATA"),s("LOCAL_STORAGE_M_RESTORE_DATA")},LOCAL_STORAGE_A_SET_LAST_MESSAGE:function(t,e){var s=t.commit,i=t.state,a=e.chat,n=e.message;i.dataLS.chats[a]||(i.dataLS.chats[a]={}),i.dataLS.chats[a].lastReadMessage=n,s("LOCAL_STORAGE_M_STORE_DATA"),s("LOCAL_STORAGE_M_RESTORE_DATA")}},getters:{LOCAL_STORAGE_G_GET_TOKEN:function(t){return t.dataLS.token},LOCAL_STORAGE_G_GET_STORAGE:function(t){return t.dataLS}}},Me={state:{currentUser:{notifications:[]},userType:null},mutations:{SESSION_M_PUSH_NOTIFICATIONS:function(t,e){t.currentUser.notifications.push(e)},SESSION_M_SET_FIELD:function(t,e){var s=e.field,i=e.value;t.currentUser[s]=i},SESSION_M_ADD_CHAT:function(t,e){t.currentUser.availableChats.push(e)}},actions:{SESSION_LOG_OUT:function(t){var e=t.dispatch,s=t.state,i=t.commit;e("LOCAL_STORAGE_A_SET_TOKEN",null),i("SOCKET_IO_M_CLOSE_CONNECTIONS"),s.currentUser={notifications:[]},s.userType="guest"},SESSION_SET_CURRENT_USER:function(t,e){var s=t.state,i=t.commit;s.currentUser=e,s.userType=e.accessRights,i("APP_M_SET_READY_STATE")},SESSION_A_JOIN_CHAT:function(t,e){var s=t.getters;s.SOCKET_IO_G_GET_MESSAGES_SOCKET.emit("chat.join",{chatID:e}),s.SOCKET_IO_G_GET_NOTIFICATIONS_SOCKET.emit("join",{chatID:e})},SESSION_A_CREATE_CHAT:function(t,e){t.getters.SOCKET_IO_G_GET_MESSAGES_SOCKET.emit("chat.create",e.data,e.cb)}},getters:{SESSION_G_GET_CURRENT_USER:function(t){return t.currentUser},SESSION_G_GET_USER_TYPE:function(t){return t.userType}}},He=s("DmT9"),Ve=s.n(He),ke={state:{socket:null,notifications:null,messages:null,unauthorized:!1},mutations:{SOCKET_IO_M_CONNECT_TO_SOCKET:function(t,e){var s=e.socket;t[e.title]=s},SOCKET_IO_M_CLOSE_CONNECTIONS:function(t){t.socket&&t.socket.close(),t.notifications&&t.notifications.close(),t.messages&&t.messages.close()}},actions:{SOCKET_IO_A_INIT_SOCKETS:function(t){var e=t.commit,s=t.getters,i=t.state,a=t.dispatch,n=JSON.parse(localStorage.getItem("data")).token;e("SOCKET_IO_M_CONNECT_TO_SOCKET",{title:"socket",socket:Ve()({query:"token="+n})}),e("SOCKET_IO_M_CONNECT_TO_SOCKET",{title:"notifications",socket:Ve()("/notifications")}),i.notifications.emit("auth",n),i.notifications.on("Unauthorized",function(){console.log("unauthorized"),i.unauthorized=!0}),i.notifications.on("authenticated",function(t){a("SESSION_SET_CURRENT_USER",t),i.notifications.on("notification.message",function(t){s.CHAT_G_GET_CHAT._id===t.chat||t.isPrivate||e("CHATLIST_M_ADD_NOTIFICATION",t)}),i.notifications.on("notification.invite",function(t){console.log("notification invite"),e("SESSION_M_PUSH_NOTIFICATIONS",t)})}),e("SOCKET_IO_M_CONNECT_TO_SOCKET",{title:"messages",socket:Ve()("/messages")}),i.messages.emit("auth",n),i.messages.on("authenticated",function(){i.messages.on("chat.leave",function(t){var s=t.id;e("CHATLIST_M_PULL_AVAILABLE_CHATS",s)}),i.messages.on("chat.join",function(t){e("SESSION_M_ADD_CHAT",t),a("CHATLIST_A_FETCH_AVAILABLE_CHATS")}),i.messages.on("message",function(t){t.error&&-1!==t.error.message.indexOf("content")?Q.pushError({message:"Sent message is empty!"}):t.error&&Q.pushError({message:"An error occurred!"});var i=s.CHAT_G_GET_CHAT,a=i.messages;t.chat===i._id&&(a[a.length-1]&&"system"!==a[a.length-1].type&&"system"!==t.type&&a[a.length-1]&&a[a.length-1].author._id===t.author._id&&(t.sameUser=!0),e("CHAT_M_ADD_MESSAGE",t))}),i.messages.on("typingUsers",function(t){e("CHAT_M_SET_TYPING_USERS",t)}),i.messages.on("users.online",function(t){e("CHAT_M_SET_ONLINE_USERS",t)})})}},getters:{SOCKET_IO_G_GET_ROOT_SOCKET:function(t){return t.socket},SOCKET_IO_G_GET_NOTIFICATIONS_SOCKET:function(t){return t.notifications},SOCKET_IO_G_GET_MESSAGES_SOCKET:function(t){return t.messages},SOCKET_IO_G_GET_UNAUTHORIZED:function(t){return t.unauthorized}}},Pe={state:{form:{email:"",password:""}},mutations:{},actions:{LOGIN_SEND_A_LOGIN_REQUEST:function(t){var e=t.state,s=t.dispatch,i=t.commit;console.log("login",{email:e.form.email,password:e.form.password}),n.a.http.post("/auth/login",{email:e.form.email,password:e.form.password}).then(function(t){i("SOCKET_IO_M_CLOSE_CONNECTIONS"),setTimeout(function(){s("LOCAL_STORAGE_A_SET_TOKEN",t.body.token.split(" ")[1]),s("APP_A_INIT_APP")},100)}).catch(function(t){console.log(t),Q.pushError({message:"User not found or incorrect password"})})}},getters:{LOGIN_G_GET_FORM:function(t){return t.form}}},De=s("M4fF"),$e=s.n(De),je={state:{form:{username:{value:"",state:!1},email:{value:"",state:!1},phone:{value:"",state:!1},password:{value:"",state:!1},passwordConf:{value:"",state:!1},age:{value:"",state:!1},gender:{value:"male",state:!0}},isValid:!1,serverResponse:{errmsg:""}},mutations:{SIGN_UP_M_SET_FIELD:function(t,e){var s=e.field,i=e.state,a=e.value,n=$e.a.cloneDeep(t.form);n[s].state=i,n[s].value=a,t.form=n},SIGN_UP_M_VALIDATE_FORM:function(t){console.log("SIGN_UP_M_VALIDATE_FORM",t.form);for(var e in t.form)if(!t.form[e].state)return void(t.isValid=!1);t.isValid=!0}},actions:{LOGIN_SEND_A_SIGN_UP_REQUEST:function(t){var e=t.state,s=t.dispatch,i=t.commit,a={};for(var r in e.form)a[r]=e.form[r].value;n.a.http.post("/auth/user",a).then(function(t){var e=t.body;e.token?(i("SOCKET_IO_M_CLOSE_CONNECTIONS"),setTimeout(function(){s("LOCAL_STORAGE_A_SET_TOKEN",e.token.split(" ")[1]),s("APP_A_INIT_APP")},100)):Q.pushError({message:"Account successfully created, but automatic log in is not available right now. Please do it manually."})}).catch(function(t){t.body.errmsg?e.serverResponse=t.body:Q.pushError({message:"Unknown issue"})})}},getters:{SIGN_UP_G_GET_FORM:function(t){return t.form},SIGN_UP_G_GET_IS_VALID:function(t){return t.isValid},SIGN_UP_G_GET_SERVER_RESPONSE:function(t){return t.serverResponse}}},Ke={state:{css:{profileAvatarClass:!1}},mutations:{PROFILE_M_SET_CSS:function(t,e){var s=e.element,i=e.value;return console.log("set css class",{element:s,value:i}),t[s]=i}},actions:{},getters:{PROFILE_G_GET_CSS:function(t){return t.css}}},We={state:{chat:{_id:null},invited:[],inviteReceivers:[],users:[]},mutations:{CHAT_SETTINGS_M_PUSH_INVITE_RECEIVERS:function(t,e){t.inviteReceivers.push(e)},CHAT_SETTINGS_M_SPLICE_INVITE_RECEIVERS:function(t,e){t.inviteReceivers.splice(e,1)},CHAT_SETTINGS_M_RESET_INVITE_RECEIVERS:function(t,e){t.inviteReceivers=[]},CHAT_SETTINGS_M_SET_FIELD:function(t,e){var s=e.field,i=e.value;t.chat[s]=i}},actions:{CHAT_SETTINGS_A_FETCH_CHAT:function(t,e){var s=t.state;t.dispatch;o.a.get("/private/chats/"+e).then(function(t){var e=t.data;s.chat=e,s.invited=e.invites.filter(function(t){return"pending"===t.state}).map(function(t){return t.receiver})}).catch(function(t){Q.pushError({message:"Cannot get chat!"})})},CHAT_SETTINGS_A_FETCH_USERS:function(t,e){var s=t.state;t.dispatch,t.getters;o.a.get("/private/users").then(function(t){s.users=t.data}).catch(function(t){Q.pushError({message:"Cannot get a list of users!"})})},CHAT_SETTINGS_A_SEND_NOTIFICATIONS:function(t,e){var s=t.state;t.dispatch;t.getters.SOCKET_IO_G_GET_NOTIFICATIONS_SOCKET.emit("notification.invite",{receivers:s.inviteReceivers,notification:{chat:s.chat._id,content:"You've been invited to \""+s.chat.title+'" chat',sender:s.chat.creator,title:"Invite to the chat"}}),s.invited=s.invited.concat(s.inviteReceivers),s.inviteReceivers=[]}},getters:{CHAT_SETTINGS_G_GET_CHAT:function(t){return t.chat},CHAT_SETTINGS_G_INVITED:function(t){return t.invited},CHAT_SETTINGS_G_INVITE_RECEIVERS:function(t){return t.inviteReceivers},CHAT_SETTINGS_G_GET_USERS:function(t){var e={};return t.chat._id&&t.chat.members.forEach(function(t){e[t._id]=!0}),t.inviteReceivers.forEach(function(t){e[t._id]=!0}),t.invited.forEach(function(t){e[t._id]=!0}),t.users.filter(function(t,s){return console.log("filter function",e[t._id]),!e[t._id]})}}};n.a.use(_.a);var qe=new _.a.Store({modules:{app:we,stocks:Re,portfolio:Ge,chat:Ue,chatlist:Le,localStorage:xe,session:Me,socketIO:ke,login:Pe,signup:je,profile:Ke,chatSettings:We}});n.a.config.productionTip=!1,n.a.use(ct.a),ot.a.Validator.extend("usernameExists",{getMessage:function(t){return"This username already exists!"},validate:function(t){return o.a.post("/public/check/username",{field:t}).then(function(t){return console.log(t.data.result),{valid:!t.data.result}}).catch(function(t){return!1})}}),ot.a.Validator.extend("emailExists",{getMessage:function(t){return"This email already exists!"},validate:function(t){return o.a.post("/public/check/email",{field:t}).then(function(t){return console.log(t.data.result),{valid:!t.data.result}}).catch(function(t){return!1})}}),ot.a.Validator.extend("chatExists",{getMessage:function(t){return"This chat title already exists!"},validate:function(t){return o.a.post("/public/check/chat/title",{field:t}).then(function(t){return{valid:!t.data.result}}).catch(function(t){return!1})}}),n.a.use(ct.a),n.a.use(lt.a),n.a.use(ot.a),n.a.use(It.a),n.a.use(s("PRyM"));var Be=new lt.a({routes:Oe});o.a.interceptors.request.use(function(t){return t.headers.authorization=""+JSON.parse(localStorage.getItem("data")).token,t},function(t){return a.a.reject(t)}),n.a.component("ww-header",_t),n.a.component("ww-notification",ft),n.a.component("addressee-list",Tt),n.a.component("input-field",At),n.a.filter("timestamp",function(t){var e=new Date(t),s=new Date(Date.now());return e.getFullYear()===s.getFullYear()&&e.getMonth()===s.getMonth()&&e.getDay()===s.getDay()?e.getHours()+" : "+e.getMinutes():e.getMonth()+"/"+e.getDay()+"/"+e.getFullYear()+" at "+e.getHours()+" : "+e.getMinutes()}),new n.a({el:"#app",router:Be,store:qe,render:function(t){return t(nt)}})},NQ7S:function(t,e){},OMCm:function(t,e){},P5kM:function(t,e){},QNsw:function(t,e){},WCsC:function(t,e){},"WVy+":function(t,e){},XGrC:function(t,e){},Xium:function(t,e){},ZBC5:function(t,e){},"bc/6":function(t,e){},c0I7:function(t,e){},"cPN+":function(t,e){},fVrm:function(t,e){},g1dx:function(t,e){},"lJ/D":function(t,e){},qDIe:function(t,e){},"r2+L":function(t,e){},sXC1:function(t,e){},tOWJ:function(t,e){},tZXH:function(t,e){},v5Eq:function(t,e){},vcTv:function(t,e){},x094:function(t,e){},zNuj:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.ae7ad412b35797ccd0d0.js.map